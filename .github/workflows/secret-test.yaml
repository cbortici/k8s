name: secret-creation-test
run-name: ${{ github.actor }} is learning GitHub Actions
on: 
  workflow_dispatch:
jobs:
  authentication:
    runs-on: ubuntu-latest
    steps:
      - name: Setup helm
        uses: azure/setup-helm@v4.2.0
      - name: Setup kubectl
        uses: azure/setup-kubectl@v3
      - uses: actions/checkout@v4
      - name: testing helm
        id: helm
        run: |
          helm version
          # echo ${{ secrets.WORKLOAD }}
          echo "YXBpVmVyc2lvbjogdjEKa2luZDogQ29uZmlnCmNsdXN0ZXJzOgotIG5hbWU6ICJjbHVzdGVyLWs4cyIKICBjbHVzdGVyOgogICAgc2VydmVyOiAiaHR0cHM6Ly9yYW5jaGVyLjM0LjIyMC40OC4yMDMuc3NsaXAuaW8vazhzL2NsdXN0ZXJzL2MtbS1oOGJscGxsdyIKICAgIGNlcnRpZmljYXRlLWF1dGhvcml0eS1kYXRhOiAiTFMwdExTMUNSVWRKVGlCRFJWSlVTVVpKUTBGVVJTMHRMUzB0Q2sxSlNVSjJWRU5EUVwKICAgICAgVmRQWjBGM1NVSkJaMGxDUVVSQlMwSm5aM0ZvYTJwUFVGRlJSRUZxUWtkTlVuZDNSMmRaUkZaUlVVdEZlRTVyWlZjMWFHSlhiR29LWVwKICAgICAga2RzZW1SSFZuVmFXRWwwWWpOS2JrMVRXWGRLUVZsRVZsRlJSRVJDTVd0bFZ6Vm9ZbGRzYW1KSGJIcGtSMVoxV2xoSmRGa3lSa0ZOVlwKICAgICAgR040VG1wTk5BcE5SR013VFVSQlpVWjNNSGxPUkVFeFRXcEplRTFxU1RGT1JFSmhSbmN3ZWs1RVFURk5ha0Y0VFdwSk1VNUVRbUZOUlwKICAgICAgVmw0U0VSQllVSm5UbFpDUVc5VUNrVXlValZpYlVaMFlWZE9jMkZZVGpCYVZ6VnNZMmt4ZG1OdFkzaEtha0ZyUW1kT1ZrSkJUVTFJVlwKICAgICAgMUkxWW0xR2RHRlhUbk5oV0U0d1dsYzFiR05wTVdvS1dWVkJlRTU2UlRKTmVtZDNUbnBSZDAxR2EzZEZkMWxJUzI5YVNYcHFNRU5CVVwKICAgICAgVmxKUzI5YVNYcHFNRVJCVVdORVVXZEJSVFJaT0dGVVlrWmtjMnQ1TkFwUlVEbExiMWRYYzBOd1UyOVZlbGRSTVc5c1RYZGplblJoWlwKICAgICAgV2RwUlVGWGFVb3liVWxwVEVWQ1dubHNRMVJOTkc1MGQydHphbWhyY0hsWk4zTlhORTl1Q21KT2VrUkxiMUF3UjJGT1EwMUZRWGRFWlwKICAgICAgMWxFVmxJd1VFRlJTQzlDUVZGRVFXZExhMDFCT0VkQk1WVmtSWGRGUWk5M1VVWk5RVTFDUVdZNGQwaFJXVVFLVmxJd1QwSkNXVVZHU1wKICAgICAgSFZLWVhveGVWWm1TMlpZZEdkdVMxSTJNUzgwZURaT1JUQnhUVUZ2UjBORGNVZFRUVFE1UWtGTlEwRXdaMEZOUlZWRFNWRkVhQXBzUlwKICAgICAgWFZOTTJabU4wb3JkMXBJVlV4VVVqRkdNV0ZhY2xCNlZFMVFRU3RUTTFSelRtRnNNa1F4UTNkSlowSmhkR3hZZFZKVFJuUkpSRU0xWlwKICAgICAgRXRoUWtkbUNrUmFia0ZhT1VsalRuaG5RWFpST1RaeFdGTkdjbWwzUFFvdExTMHRMVVZPUkNCRFJWSlVTVVpKUTBGVVJTMHRMUzB0IgoKdXNlcnM6Ci0gbmFtZTogImNsdXN0ZXItazhzIgogIHVzZXI6CiAgICB0b2tlbjogImt1YmVjb25maWctdXNlci00OGttazd6NDk5Ojg2dnR6enAyNGJ6c2R0NWI2enMycDd0N3c5cTdrOXB3czY0a2d3cHNuamx0YzdidHp4cmN6OSIKCgpjb250ZXh0czoKLSBuYW1lOiAiY2x1c3Rlci1rOHMiCiAgY29udGV4dDoKICAgIHVzZXI6ICJjbHVzdGVyLWs4cyIKICAgIGNsdXN0ZXI6ICJjbHVzdGVyLWs4cyIKCmN1cnJlbnQtY29udGV4dDogImNsdXN0ZXItazhzIg==" | base64 --decode > kube_config_workload.yaml
          kubectl get nodes --kubeconfig kube_config_workload.yaml
      # - name: Testing secret
      #   id: secret
      #   run: |
      #     echo 'helloworldsodjwiqojdwjdihwduwqdoiwqjdoiwqjdijqwoidjoiJWQOIDJOqjdow' > test
      #     base64 test > file
      #     secret=$(cat file)
      #     echo $secret
      #     echo "::set-output name=secret::$secret"
      # - uses: hmanzur/actions-set-secret@v2.0.0
      #   with:
      #     name: 'helloworld'
      #     value: '$secret'
      #     repository: 'cbortici/k8s'
      #     token: ${{ secrets.TEST }}
      # - name: verifying secret
      #   run: |
      #     echo -n "${{ secrets.WORKLOAD }}" >> foo && cut -c1-3 foo && cut -c4
      #     echo "added on ${{steps.secret.outputs.secret}}"
